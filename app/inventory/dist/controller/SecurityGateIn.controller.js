sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/ui/core/ValueState"],function(e,t,n,i){"use strict";let a=0;return e.extend("inventory.controller.SecurityGateIn",{onInit:function(){let e={startDate:"",endDate:""};let t=new n(e);this.getView().setModel(t,"dateModel");const i=this.getOwnerComponent().getRouter();i.getRoute("RouteWarehouseMain").attachPatternMatched(this.onRouteMatched,this)},onRouteMatched:function(){this.refreshFragment()},refreshFragment:function(){let e=this.byId("CharteringRqNo");let t=this.byId("requestMaterialDetailsLayout");if(e||t){e.setValue("");t.setVisible(false);this.byId("myDatePicker").setValue("");this.byId("myDatePicker1").setValue("")}},removeCommas:function(e){if(e){return e.toString().replace(/,/g,"")}return e},_onStartDateFilter:function(){let e=this.getView().getModel("dateModel").getData();let t=e.endDate;if(t){this._onDateFilter()}},_onDateFilter:async function(){let e=this.getView().getModel("dateModel").getData();let t=new Date(e.startDate);let i=new Date(e.endDate);i.setHours(23,59,59,999);let a=this.getView().getModel();let r=a.bindList("/serviceRequest",undefined,undefined,undefined,undefined);let s=await r.requestContexts(0,Infinity);let o=s.map(e=>e.getObject());let l=o.filter(e=>{let n=new Date(e.createdAt);return n>=t&&n<=i});if(l.length>0){this.byId("requestMaterialDetailsLayout").setVisible(true)}let u=l.filter(e=>!e.reqStatus.includes("Inspection Completed"));console.table(u);let c=new n(u);this.getView().setModel(c,"materialData")},onMaterialRowSelect:function(e){const t=e.getSource().getBindingContext("materialData");const n=t.getObject().reqNo;const i=t.getObject().reqStatus;const a={reqNo:n,reqStatus:i};sessionStorage.setItem("materialData",JSON.stringify(a));const r=this.getOwnerComponent().getRouter();r.navTo("RouteGateMaterial")},formatDate:function(e){if(!e)return"";let t=new Date(e);let n=String(t.getDate()).padStart(2,"0");let i=String(t.getMonth()+1).padStart(2,"0");let a=t.getFullYear();return`${n}-${i}-${a}`},formatTime:function(e){if(!e)return"";let t=new Date(e);let n=String(t.getHours()).padStart(2,"0");let i=String(t.getMinutes()).padStart(2,"0");return`${n}:${i}:00`},getBindServices:async function(e){try{let t=parseInt(e.replace(/,/g,""));let i=this.getOwnerComponent().getModel();let a=i.bindList("/serviceRequest",undefined,undefined,undefined,undefined);let r=await a.requestContexts(0,Infinity);let s=r.map(e=>e.getObject());let o=s.filter(e=>e.reqNo===t);let l=new n(o);this.getView().setModel(l,"materialData")}catch(e){console.error("Error fetching bid details:",e.message)}},statusFormatter:function(e){switch(e){case"Open":return i.Warning;case"CLOSED":return i.Error;default:return i.Information}},_onStatusTypeChange:function(e){var t=e.getSource();var n=t.getSelectedItem().getText();console.log("selected item",n);if(n==="Partial"){this.onPartialBtnPress(t)}},onServiceRequestNumber:function(e){const n=this.getView();this._oInputField=e.getSource();if(!this.requestNoFragment){t.load({id:n.getId(),name:"inventory.fragments.SecurityValueHelp",controller:this}).then(e=>{this.requestNoFragment=e;n.addDependent(this.requestNoFragment);this.requestNoFragment.open()})}else{this.requestNoFragment.open()}},onValueHelpClosevoy:async function(e){const t=e.getParameter("selectedItem");if(t){const e=t.getTitle();this._oInputField.setValue(e);if(e){this.byId("requestMaterialDetailsLayout").setVisible(true)}this.serviceNo=e;try{await this.getBindServices(e)}catch(e){console.log("Selected item is not found")}}},onPartialBtnPress:function(e){var t=e.getParent();var n=t.getCells()[1];var i=t.getCells()[3];if(n instanceof sap.m.Input){n.setEditable(true)}if(i instanceof sap.m.Input){i.setEditable(true)}},expandTableField:function(){let e=t.byId(this.getView().getId(),"expandSubTable");let n=e.getItems();n.forEach(function(e){let t=e.getCells()[1];let n=e.getCells()[3];if(t instanceof sap.m.Input){t.setEditable(true)}if(n instanceof sap.m.Input){n.setEditable(true)}})},_onCancelCheckinSubFragment:function(){this.expandCheckinDataFragment.close()},onExit:function(){}})});
//# sourceMappingURL=SecurityGateIn.controller.js.map